# @/config/authorizer/policy.csv
# Format: p, subject (role/membership), resource_path, action, effect
# ===========================================================================

# 1. SUPERUSER ROLE
# The president has god-mode access. The scope for this role must be '*'.
p, role_president, /*, *, allow

# 2. FINANCE MODULE (Highly Restricted)
# Financial secretary has full control over the finance module.
p, role_financial_secretary, /finance/*, *, allow
# Auditors get read-only access to the finance module.
p, AUDITOR, /finance/*, GET, allow
# Donors can create donations and view their own.
p, DONOR, /finance/donations, POST, allow
p, SELF, /constituents/:id/donations, GET, allow

# 3. COMMUNICATIONS MODULE
# Secretary has full control over the communications module.
p, role_secretary, /communications/*, *, allow
# Members can read announcements and meeting info.
p, MEMBER, /communications/announcements, GET, allow
p, MEMBER, /communications/meetings, GET, allow
p, MEMBER, /communications/meetings/:id, GET, allow

# 4. CORE MANAGEMENT ROLES (Scoped)
# Chapter heads can manage their specific chapter and its members/projects.
p, role_chapter_head, /chapters/:id, PUT, allow
p, role_chapter_head, /chapters/:id/members, *, allow
p, role_chapter_head, /chapters/:id/projects, POST, allow

# Committee heads can manage their specific committee and its members.
p, role_committee_head, /committees/:id, PUT, allow
p, role_committee_head, /committees/:id/members, *, allow

# 5. ACTIVITY MANAGEMENT ROLES (Can be global or scoped)
# Organizers can manage events and projects.
p, role_organizer, /events, POST, allow
p, role_organizer, /events/:id, PUT, allow
p, role_organizer, /events/:id, DELETE, allow
p, role_organizer, /projects, POST, allow
p, role_organizer, /projects/:id, PUT, allow
p, role_organizer, /projects/:id, DELETE, allow

# 6. SELF-SERVICE & PARTICIPATION
# Any authenticated user can manage their own constituent profile.
p, SELF, /constituents/:id, GET, allow
p, SELF, /constituents/:id, PUT, allow

# Members and Volunteers can participate in events.
p, MEMBER, /events/:id/participations, POST, allow
p, MEMBER, /events/:id/participations, DELETE, allow
p, VOLUNTEER, /events/:id/participations, POST, allow
p, VOLUNTEER, /events/:id/participations, DELETE, allow

# 7. BASELINE READ ACCESS (By Membership Type)
# Permissions for Members.
p, MEMBER, /chapters, GET, allow
p, MEMBER, /committees, GET, allow
p, MEMBER, /events, GET, allow
p, MEMBER, /events/:id, GET, allow
p, MEMBER, /projects, GET, allow
p, MEMBER, /projects/:id, GET, allow

# Permissions for Volunteers.
p, VOLUNTEER, /chapters, GET, allow
p, VOLUNTEER, /committees, GET, allow
p, VOLUNTEER, /events, GET, allow
p, VOLUNTEER, /events/:id, GET, allow

# Permissions for Donors.
p, DONOR, /chapters, GET, allow
p, DONOR, /events, GET, allow